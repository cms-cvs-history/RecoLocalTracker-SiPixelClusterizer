process ProcessPixelClusterizer = {

# works with 2-0-0, 2/08 d.k.

   source = PoolSource { 
     # untracked vstring fileNames    = {'file:digis.root'}
     untracked vstring fileNames = {
#	'file:/scratch/dkotlins/Muon_FullValidation_180pre5.root',
#	'rfio:/castor/cern.ch/user/c/chiochia/cmssw/QCD_210_FEVTSIM_2008_04_17.root'
	'/store/relval/2008/4/17/RelVal-RelValSingleMuPt100-1208465820/0000/6C70FC08-D80C-DD11-9744-000423D944F0.root'
	}

     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
   }

  untracked PSet maxEvents = {untracked int32 input = 1000}

  # Initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Tracker SimGeometryXML
  include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

  # Tracker Geometry Builder
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # Tracker Numbering Builder
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  # Message Logger
   service = MessageLogger {
     untracked vstring destinations   = { "debugmessages.txt" }
     untracked PSet debugmessages.txt = { untracked string threshold = "DEBUG"}
     untracked vstring debugModules = { "siPixelClusters"}
   } 


  #SQL database access
  include "CondCore/DBCommon/data/CondDBCommon.cfi"
  replace CondDBCommon.connect = "sqlite_file:/afs/cern.ch/cms/Tracker/Pixel/configuration/prova_db_0point02percent_deadpixels_CMSSW21X.db"
  #replace CondDBCommon.DBParameters.authenticationPath = "afs/cern.ch/cms/DB/conddb"
  replace CondDBCommon.DBParameters.authenticationPath = "."

  #Get Calibration data from DB
  es_source = PoolDBESSource{
	using CondDBCommon
	  VPSet toGet = {
			 {string record = "SiPixelGainCalibrationOfflineRcd" string tag = "V2_deadpixels_002percent"},
			 {string record = "SiPixelFedCablingMapRcd" string tag = "FedCablingMap_for_testing"},
			 {string record = "SiPixelLorentzAngleRcd"  string tag = "LorentzAngle_for_testing"}
			}
	untracked string BlobStreamerName = "TBufferBlobStreamingService"
  }                 


   # to avoid the DB problem"
   #include "CalibTracker/Configuration/data/Tracker_FakeConditions.cff"

   # Gain Calibration DB ESSource
   # include "CondTools/SiPixel/data/SiPixelGainCalibrationESSource.cfi"
   # include "CalibTracker/SiPixelESProducers/data/SiPixelFakeGainESSource.cfi"

   es_prefer = PoolDBESSource{}

############################################################################
#  Run the clusterizer. Parameter values from default cfi file.
#
   include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"
############################################################################

    module out = PoolOutputModule {
        untracked string fileName = 'pixClusters.root'
	untracked vstring outputCommands = 
	{
	  "drop SiPixelClusteredmDetSetVector_*_*_*"
#	  "keep SiPixelClusteredmNewDetSetVector_*_*_*"
	}
    }
    path p = {siPixelClusters}


   endpath outpath = { out }

}
