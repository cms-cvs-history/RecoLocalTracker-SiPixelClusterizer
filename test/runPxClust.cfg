process ProcessPixelClusterizer = {

# works with 2-0-0, 2/08 d.k.

   source = PoolSource { 
     untracked vstring fileNames = {
	'file:18A80181-5326-DD11-9498-001617E30D0A.root'}

     untracked uint32 debugVebosity = 10
     untracked bool   debugFlag     = true
   }

  untracked PSet maxEvents = {untracked int32 input = 1000}
  untracked PSet options = { untracked bool wantSummary = true }

  # Initialize magnetic field
  include "MagneticField/Engine/data/volumeBasedMagneticField.cfi"

  # Tracker SimGeometryXML
  include "Geometry/TrackerSimData/data/trackerSimGeometryXML.cfi"

  # Tracker Geometry Builder
  include "Geometry/TrackerGeometryBuilder/data/trackerGeometry.cfi"

  # Tracker Numbering Builder
  include "Geometry/TrackerNumberingBuilder/data/trackerNumberingGeometry.cfi"

  # Mixing
  include "Configuration/StandardSequences/data/MixingNoPileUp.cff"

  # Digitizer
  include "SimTracker/SiPixelDigitizer/data/PixelDigi.cfi"

  # Random number 
      service = RandomNumberGeneratorService {
	untracked uint32 sourceSeed = 135799753
	PSet moduleSeeds =
	{
	    untracked uint32 VtxSmeared = 123456789
	    untracked uint32 g4SimHits = 194098651
	    untracked uint32 mix = 9823
	    untracked uint32 simSiPixelDigis = 923
	}
    }

  # Message Logger
   service = MessageLogger {
     untracked vstring destinations   = { "debugmessages.txt" }
     untracked PSet debugmessages.txt = { untracked string threshold = "DEBUG"}
     untracked vstring debugModules = { "siPixelClusters"}
   } 

  # Timing

  service = Timing{}

  #SQL database access
  #include "CondCore/DBCommon/data/CondDBCommon.cfi"
  #replace CondDBCommon.connect = "sqlite_file:/afs/cern.ch/cms/Tracker/Pixel/configuration/prova_db_0point02percent_deadpixels_CMSSW21X.db"
  #replace CondDBCommon.DBParameters.authenticationPath = "afs/cern.ch/cms/DB/conddb"
  #replace CondDBCommon.DBParameters.authenticationPath = "."

  #Get Calibration data from DB
  #es_source = PoolDBESSource{
  #	using CondDBCommon
  #	  VPSet toGet = {
  #			 {string record = "SiPixelGainCalibrationOfflineRcd" string tag = "V2_deadpixels_002percent"},
  #			 {string record = "SiPixelFedCablingMapRcd" string tag = "FedCablingMap_for_testing"},
  #			 {string record = "SiPixelLorentzAngleRcd"  string tag = "LorentzAngle_for_testing"}
  #			}
  #	untracked string BlobStreamerName = "TBufferBlobStreamingService"
  #}                 


   # to avoid the DB problem"
   include "CalibTracker/Configuration/data/Tracker_FakeConditions.cff"

   # Gain Calibration DB ESSource
   # include "CondTools/SiPixel/data/SiPixelGainCalibrationESSource.cfi"
   # include "CalibTracker/SiPixelESProducers/data/SiPixelFakeGainESSource.cfi"

   #es_prefer = PoolDBESSource{}

############################################################################
#  Run the clusterizer. Parameter values from default cfi file.
#
   include "RecoLocalTracker/SiPixelClusterizer/data/SiPixelClusterizer.cfi"
   replace siPixelClusters.src = simSiPixelDigis
############################################################################

    module out = PoolOutputModule {
        untracked string fileName = 'pixClusters.root'
	untracked vstring outputCommands = 
	{
	  "drop SiPixelClusteredmDetSetVector_*_*_*",
	  "keep SiPixelClusteredmNewDetSetVector_*_*_*"
	}
    }
    path p = {mix, simSiPixelDigis, siPixelClusters}


   endpath outpath = { out }

}
