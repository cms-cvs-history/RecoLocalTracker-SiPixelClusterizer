process PROD = {

	source = PoolSource { 
          # untracked string fileName = '/afs/fnal.gov/files/home/room2/petar/data/pixdigi.root'
          untracked string fileName = '../../../data/pgun_digis_01.root'
          untracked int32 maxEvents = 10
          untracked uint32 debugVebosity = 10
          untracked bool   debugFlag     = true
	}

	es_source magfield = XMLIdealGeometryESSource {
		  FileInPath GeometryConfiguration ="SimG4Core/Application/test/FieldConfiguration.xml"
		  #the proper root node is set in the xml file
		  string rootNodeName=""
		}
        es_module = VolumeBasedMagneticFieldESProducer {
 	           double findVolumeTolerance = 0.0
 	           untracked bool cacheLastVolume = true
	           untracked bool timerOn = false
		}


        es_source = XMLIdealGeometryESSource {FileInPath
           GeometryConfiguration="Geometry/TrackerSimData/data/trackerSimConfiguration.xml"
           string rootNodeName = ""}

        es_module = TrackerGeometricDetESModule {}

        es_module = TrackerDigiGeometryESModule {}

  	# From Danek: the thresholds in ORCA  are
        # channel = 5
        # seed = 6
        # cluster = 10.1
        # in noise units.
        # From the digitizer you get pixel hits in ADC units.
        # So we need to translate the threshold from noise units to
        # ADC:
        # channel = 18.5
        # seed = 22.2
        # cluster = 37.4
        # Note from Petar: the code actually wants thresholds in noise units
	module pixClust =  SiPixelClusterProducer {
           # string DigiProducer     = "SimDigitizer"	
           string DigiProducer     = "pixdigi"	
	   string ClusterMode      = "PixelThresholdClusterizer"
	   double ChannelThreshold = 5
           double SeedThreshold    = 6
           double ClusterThreshold = 10.1
           bool   DetailedTiming   = 2
	   untracked int32 VerbosityLevel = 1		 
	}

       module out = PoolOutputModule {
               untracked string fileName = 'pixClusters.root'
        }
	path p = {pixClust,out}
}
